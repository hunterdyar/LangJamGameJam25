(components grid)

{on-spawn 
	(set-in grid scale 75)
	(set-in grid x-offset 0)
	(set-in grid y-offset 50)
	(set-in grid rows 1)
	(set-in grid cols 3)
	(set-in grid h-align center)
	(set-in grid v-align middle)
	(set @p (find-type player))
	(set @card-h (list "move-left-h" "move-swap-h" "move-right-h"))
	(set @card (list "move-left" "move-swap" "move-right"))
	(set @calls (list "p-move-left" "p-move-swap" "p-move-right"))

	(set @highlighted-card 1)
}

{render
	(for @i @j :card
		[
		(if (eq :i :highlighted-card) 
			(draw-grid-sprite :grid :i 0 (get :card-h :i))
			(draw-grid-sprite :grid :i 0 :j)
		)
#		(get :card :i)
		]
	)
}

#{get-card-sprite n (
#	(print :n)
#))
#}

{on-input-left
 (if (gt :highlighted-card 0)
	(set highlighted-card (dec :highlighted-card))
  )
}
{on-input-right
	(if (lt :highlighted-card (dec (count :card)) 1)
		(set highlighted-card (inc :highlighted-card))
	)
}

{on-input-select
	(print "start turn. Doing player move.")
	(start-routine [
	(print (get :card :highlighted-card))
	(broadcast (get :calls :highlighted-card))
	(print "player moves. now enemies move.")
	(broadcast enemy-turn)
	(print "player moves. broadcasting to decide next.")
	(broadcast decide-next)
	])
}